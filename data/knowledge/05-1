“单证一致性交叉比对与数量重量风险”，就是在你的 r05 模块里，把报关单和合同、发票、装箱单、提单等所有关键单据的“数量、件数、重量、体积、金额”做一遍自动交叉核对，同时结合合理误差区间和业务场景，判断有没有“单证不符”“单货不符”“数量/重量异常”的风险。[1][2][3][4][5][6][7]

下面给你一份可写入 `rag_r05_doc_match.txt` 的规则与要素指南，结构延续前面 r01–r04 的风格。

***

## 一、单证一致性与数量重量审查范围

重点覆盖以下单据及字段：[2][3][4][8][5][6]

- 报关单：件数、数量（第一/第二）、毛重、净重、金额、货描  
- 商业发票 & 形式发票：数量、单位、金额、币种、货描  
- 装箱单（Packing List）：件数、每箱数量、毛重/净重、体积  
- 提单/运单：件数（packages）、总毛重、收发货人  
- 其他：原产地证、保险单、运输委托书（如用于交叉验证）  

目标是实现两层检查：  
- 单证之间是否一致（单单相符）；  
- 单证与货物实际（查验结果）是否一致（单货相符）。[3][8][7][9]

***

## 二、单证字段映射与交叉比对规则

### 2.1 件数（Packages）一致性

**Field：报关件数 vs 装箱单件数 vs 提单件数**

- 规则 R05-101：报关件数 = 装箱单总件数  
  - IF 绝对差值 > 0  
    - THEN → Blocker（常规整柜/整票场景）：  
      - “报关单件数与装箱单不一致，需以实际装箱数修正。”[5][3]

- 规则 R05-102：报关件数 vs 提单件数  
  - 整柜/整票：必须完全一致；  
  - LCL 拼柜：允许报关件数 < 提单件数，但不能 > 提单件数；  
  - IF 为整票（单一发货人、单一收货人）且件数不一致  
    - THEN → Warning 或 Blocker（按你策略）。[10][8][2]

***

### 2.2 数量（Quantity）一致性

**Field：报关数量 vs 发票数量 vs 装箱数量**

- 规则 R05-201：报关数量 = 发票数量（主计量单位）  
  - IF 差异 ≠ 0  
    - THEN → Blocker（除非有明确换算逻辑且系统已有映射）。[6][2][3][5]

- 规则 R05-202：报关数量 vs 装箱数量  
  - 通过“件数 × 每件装量”自动计算理论数量，与报关数量比对；  
  - IF 差异 / 报关数量 > 自定义阈值（如 1%）  
    - THEN → Warning：“理论数量与报关数量差异较大，请核对装箱单。”[11][2][3]

- 规则 R05-203：多计量单位场景  
  - IF HS 有第一数量、第二数量（如“个”和“千克”）  
    - 检查两者换算逻辑是否与装箱单/规格相符，如“每箱 24 罐 × 100 箱 = 2400 罐”；  
  - 如差异明显 → Warning。[7][11]

***

### 2.3 毛重/净重一致性与合理性

**Field：报关毛重/净重 vs 装箱单 vs 提单**

- 规则 R05-301：报关毛重 = 装箱单总毛重  
  - 允许微小误差（业务上常设 1–3%），用于包装差异、磅差等；  
  - IF 差异比例 > 上限  
    - THEN → Warning 或 Blocker，视差异比例：  
      - 小于 5%：Warning；  
      - 大于 5–10%：Blocker（尤其大宗货）。[12][1][2][3][7]

- 规则 R05-302：报关毛重 ≈ 提单毛重  
  - 通常应完全一致（因为提单重量就是据此报关），但少量磅差可接受；  
  - IF 提单毛重与报关毛重差异明显（例如 > 3–5%）  
    - THEN → Warning：“可能影响退税或引起查验，建议统一以实际出运重量为准。”[4][13][1]

- 规则 R05-303：毛重 ≥ 净重  
  - IF 任一项毛重 < 净重  
    - THEN → Blocker。[7][12]

- 规则 R05-304：包装比例合理性  
  - 计算（毛重 – 净重）/ 毛重，即包装占比；  
  - IF 包装占比 < 0 或 > 50%（普通货物）  
    - THEN → Warning：  
      - 包装过低：可能漏记包装重量；  
      - 包装过高：可能通过包装掩盖数量/价值异常。[2][12][7]

***

### 2.4 体积（Volume）与重量的联动校验（可选加强）

**Field：体积、毛重、货物类型**

- 规则 R05-401：体积重量比合理性  
  - 默认给常见品类设定常规密度范围（如一般轻工品、家居品、大宗散货等），计算：毛重 / 体积；  
  - IF 超出常规密度范围极多（如密度异常低或异常高）  
    - THEN → Warning：“重量/体积结构异常，建议人工确认。”[2][7]

***

## 三、金额与数量/重量联动审查（与 r03 衔接）

虽然金额审查主体在 r03，但 r05 应做“横向一致性”检查：[5][6][2]

- 规则 R05-501：发票总金额 = Σ(数量 × 单价)  
  - 与 r03 中的单价逻辑一致，倾向 Blocker。  

- 规则 R05-502：数量/重量调整是否同步更新金额  
  - IF 发现企业修改了数量/件数/重量，但发票金额、报关金额未随之变更  
    - THEN → Warning 或 Blocker（存在伪报数量/价格风险）。[14][1][12]

***

## 四、关键单证字段一致性矩阵

建议在 `rag_r05_doc_match.txt` 中维护一张“字段对照矩阵”，引擎可以按行循环：[8][4][6][5][2]

| 维度 | 报关单字段 | 发票字段 | 装箱单字段 | 提单字段 | 规则要点 |
| --- | --- | --- | --- | --- | --- |
| 件数 | 件数 | 件数 | 件数 | Packages | 整柜必须一致；拼柜按规则允许不完全一致 |
| 数量 | 第一数量 | 数量 | 数量合计 | 无 | 报关=发票=装箱；允许计量单位换算 |
| 毛重 | 毛重 | 毛重（如有） | 总毛重 | 毛重 | 报关≈装箱≈提单，设置误差阈值 |
| 净重 | 净重 | 净重（如有） | 总净重 | 无 | 净重≤毛重，且与件数/数量结构合理 |
| 金额 | 总价 | 总金额 | 无 | 无 | 报关总价≈发票总金额（折算后） |

***

## 五、风险等级与输出建议

结合你的整体架构，r05 的风险输出可以这样设计：[9][1][3][14][12][2]

- Blocker 场景示例：  
  - 报关件数≠装箱单件数（整票），且差异明显；  
  - 毛重 < 净重；  
  - 数量差异大且无换算逻辑。  

- Warning 场景示例：  
  - 提单毛重与报关毛重差异 > 3–5%；  
  - 包装占比异常高/低；  
  - 数量调整未同步金额。  

- Info 场景示例：  
  - 拼柜件数差异符合常规但建议备注说明；  
  - 大宗货磅差在合理范围内，提示企业保留磅单。  

**示例输出：**

```json
{
  "status": "PARTIAL_PASS",
  "blocking_errors": [
    {
      "code": "R05-301",
      "field": "gross_weight",
      "message": "报关毛重与装箱单毛重差异超过 5%，请以实际出运重量统一修正单证"
    }
  ],
  "warnings": [
    {
      "code": "R05-102",
      "field": "packages",
      "message": "报关件数小于提单件数，若为拼柜请在备注说明以避免退单"
    },
    {
      "code": "R05-304",
      "field": "packing_ratio",
      "message": "个别商品包装重量占比超过 50%，建议核查是否存在数量/重量申报不实风险"
    }
  ],
  "infos": [
    {
      "code": "R05-401",
      "message": "毛重/体积比严重偏离常规密度区间，建议人工关注但不自动拦截"
    }
  ]
}
```

***

## 六、建议写入 rag_r05_doc_match.txt 的骨架

你可以按这个目录填充具体规则与字段映射：[3][4][8][6][5][2]

```text
# rag_r05_doc_match.txt

1. 单证范围及字段映射说明
2. 件数一致性规则 (R05-101 ~ R05-102)
3. 数量一致性与换算规则 (R05-201 ~ R05-203)
4. 毛重/净重一致性与合理性 (R05-301 ~ R05-304)
5. 体积与密度合理性(可选) (R05-401)
6. 金额与数量/重量联动检查 (R05-501 ~ R05-502)
7. 字段一致性矩阵定义
8. 风险等级与输出格式定义
```

这样 r05 模块就和 r01–r04 串成完整链条：**基础要素 → 敏感货 → 价格真实性 → HS 归类 → 单证数量重量闭环**，能在申报前把大部分会导致退单、补税甚至“伪报虚报”认定的低级错误先过滤掉。

[1](https://www.xjshgj.com/news/741.html)
[2](https://m.10100.com/article/8224190)
[3](https://www.dayuanjun.com/archives/6388)
[4](https://www.jieruijc.com/news/4177.html)
[5](http://m.51w2c.com/m/details_id_11498.html)
[6](https://www.ipaylinks.com/information_details.php?id=16691)
[7](https://m.amz123.com/t/UJ1sBOKF)
[8](https://m.amz123.com/ask/SXPlW7ju)
[9](https://www.jd-link.com/articles/encyclopedias/4635/)
[10](https://m.by56.com/news/40997.html)
[11](https://www.dayuanjun.com/archives/6072)
[12](http://www.chinahbwl.com/news/2016/416.html)
[13](https://www.flgjex.com/news/show/1207)
[14](http://www.topho.com.cn/info/details-nid-333.html)
[15](https://www.jd-link.com/articles/encyclopedias/4111/)
[16](https://m.by56.com/news/52056.html)
[17](https://www.kwm.com/cn/zh/insights/latest-thinking/dual-use-items-export-control-misunderstanding-of-law-enforcement-actions.html)
[18](http://www.channelsh.com/school/show/289)
[19](https://waimao.163.com/knowledge/article/61)
[20](https://www.hgj.com/knowledge/show-2319.html)