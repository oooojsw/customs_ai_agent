这是一个专为**规则引擎（Rule Engine）**配置设计的详细审查元素列表。我将其结构化为**字段域（Field）**、**检查规则（Logic/Rule）**、**校验类型（Type）**和**异常提示（Message）**，可以直接用于映射系统规则。

这个列表覆盖了海关单一窗口（Single Window）的核心逻辑检控规则。

### 第一部分：表头基础信息校验 (Header Level)

这些规则主要校验报关单顶部的通用信息，确保贸易背景逻辑自洽。

| 字段域 (Field) | 校验规则 (Logic / Rule) | 校验类型 | 异常提示示例 |
| :--- | :--- | :--- | :--- |
| **申报地海关** | 必须在《海关关区代码表》中存在，且状态为有效。 | 参照完整性 | 申报地海关代码不存在或已停用。 |
| **进出口日期** | 格式必须为 `YYYYMMDD`；不能晚于当前日期（逻辑上不能预知未来太久，视具体业务而定）；出口日期不能早于申报日期（一般情况）。 | 格式/逻辑 | 日期格式错误或日期逻辑不符。 |
| **监管方式 (贸易方式)** | 必须在《监管方式代码表》中。 | 参照完整性 | 监管方式代码无效。 |
| **征免性质** | **强关联校验**：<br>`IF` 监管方式 = "0110" (一般贸易) `THEN` 征免性质通常应为 "101" (一般征税) 或 "299" (其他法定)。<br>`IF` 监管方式 = "0214" (来料加工) `THEN` 征免性质应为 "503" (进料加工) 等特定值。 | **关联逻辑** | 监管方式与征免性质逻辑不匹配，请核对。 |
| **成交方式** | `IF` 成交方式 = "1" (CIF) `THEN` [运费]、[保费] 栏位应为空或标记为包含。<br>`IF` 成交方式 = "3" (FOB) `THEN` [运费] 必须填写（数值>0 或 率>0）。 | **关联逻辑** | FOB成交方式下运费不能为空。 |
| **运输方式** | 必须在《运输方式代码表》中（如 2=水路, 5=航空）。 | 参照完整性 | 运输方式代码无效。 |
| **提运单号** | 禁止包含中文、全角字符；禁止包含空格；长度一般不超过32位。 | 格式校验 | 提运单号包含非法字符或长度超标。 |
| **毛重 (Gross Weight)** | 数值必须 > 0；小数位最多4位。 | 格式校验 | 毛重必须大于0。 |
| **净重 (Net Weight)** | 数值必须 > 0；小数位最多4位。 | 格式校验 | 净重必须大于0。 |
| **毛净重逻辑** | **核心规则**：`毛重` >= `净重`。 | **逻辑校验** | 逻辑错误：净重不能大于毛重。 |
| **集装箱号** | (若运输方式=水路) 格式须符合 `4位字母` + `7位数字` 标准 (ISO 6346)。 | 正则表达式 | 集装箱号格式不规范（需符合4字母+7数字）。 |
| **随附单证** | `IF` 监管方式涉及许可证（如代码含'A'/'B'等），此栏必须非空，且能够正则匹配到许可证号格式。 | 业务逻辑 | 缺少必要的监管证件或许可证号。 |

***

### 第二部分：表体商品项校验 (Item Level)

这是报关单的核心部分，规则引擎需循环检查每一个商品项（Item Row）。

| 字段域 (Field) | 校验规则 (Logic / Rule) | 校验类型 | 异常提示示例 |
| :--- | :--- | :--- | :--- |
| **商品编码 (HS Code)** | 必须是《海关进出口税则》中有效的8位或10位编码；必须在有效期内。 | 参照完整性 | 商品编码不存在或已过期。 |
| **商品名称** | 禁止出现“样品”、“零件”、“配件”、“衣服”等模糊词汇（需启用模糊词库匹配）；禁止全数字或全英文（除非特定允许）。 | 文本分析 | 商品名称申报过于笼统，请具体化。 |
| **申报要素 (G Report)** | **动态规则**：根据输入的HS Code，调取该编码对应的“要素项”要求。<br>1. **完整性**：所有必填要素（如：1.品名; 2.材质...）必须有值。<br>2. **格式**：不得填写“无”、“/”、“同上”等无效字符。 | **动态完整性** | 申报要素项缺失或填写不规范。 |
| **数量 (成交)** | 数值 > 0。 | 格式校验 | 成交数量必须大于0。 |
| **单位 (成交)** | 必须在《计量单位代码表》中。 | 参照完整性 | 成交计量单位无效。 |
| **单位 (法定/第一)** | **强校验**：必须与HS Code库中规定的“第一计量单位”完全一致（如：HS规定是千克，不能填个）。 | **一致性** | 第一计量单位与税则规定不符。 |
| **数量 (法定/第一)** | `IF` 法定单位 = "千克"，则校验：`第一数量` $\approx$ `净重` (允许一定偏差，如±10%)。 | **逻辑校验** | 法定数量（重量）与净重差异过大。 |
| **单价 & 总价** | 1. 数值 > 0。<br>2. **计算逻辑**：`ABS(单价 * 数量 - 总价)` < 阈值 (如 1.00)。 | **数学逻辑** | 单价乘以数量不等于总价（误差超限）。 |
| **币制** | 必须在《币制代码表》中 (如 502=USD)。 | 参照完整性 | 币制代码错误。 |
| **原产国/最终目的国** | 必须在《国别地区代码表》中。 | 参照完整性 | 原产国/目的国代码错误。 |
| **原产地预警** | `IF` 涉及反倾销商品 (根据HS Code判别) `AND` 原产国 = 涉案国家 `THEN` 触发强提示或阻断。 | 风险逻辑 | 该商品涉及反倾销，请确认原产地无误。 |
| **品牌类型** | 必须选择：0-无品牌, 1-境内自主品牌, 2-境内收购品牌, 3-境外品牌(贴牌), 4-境外品牌(其他)。 | 枚举校验 | 品牌类型值域错误。 |
| **享惠情况** | `IF` 原产国 = [RCEP成员国] `AND` 享惠情况 = "不享惠"，提示确认是否漏报优惠。 | 业务提示 | 原产地为协定国家，请确认是否申请享惠。 |

***

### 第三部分：跨表/单证链一致性校验 (Cross-Document Logic)

如果您的规则引擎可以接入发票、装箱单数据，可增加此类校验。

| 字段域 (Field) | 校验规则 (Logic / Rule) | 校验类型 | 异常提示示例 |
| :--- | :--- | :--- | :--- |
| **单单总金额** | `SUM(表体所有项总价)` == `发票总金额`。 | 一致性 | 报关单总金额与发票总金额不一致。 |
| **单单总净重** | `SUM(表体所有项净重)` == `装箱单总净重` == `表头净重`。 | 一致性 | 商品项净重之和不等于表头净重。 |
| **件数逻辑** | `表头件数` == `装箱单总件数`。 | 一致性 | 报关单件数与装箱单不符。 |
| **合同号一致性** | 报关单“合同协议号” == 随附合同文件编号。 | 一致性 | 合同号与上传合同文件不匹配。 |

### 实施建议

在将这些填入规则引擎（如 Drools, EasyRules, 或自研引擎）时，建议设置三个**等级（Level）**：

1.  **Blocker (阻断)**：格式错误、数学逻辑错误、监管代码错误。（如：毛重 < 净重） -> **无法申报**
2.  **Warning (警告)**：价格波动过大、逻辑可疑但可能存在。（如：第一数量与净重差异 > 20%） -> **需要人工确认**
3.  **Info (提示)**：享惠提示、规范性建议。（如：建议补充品牌授权书） -> **仅展示**